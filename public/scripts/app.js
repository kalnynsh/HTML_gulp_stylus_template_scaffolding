"use strict";

(function ($) {
  $(document).ready(function () {
    var form = document.forms.form01;
    var inputName = form.elements.inputName;
    var phone = form.elements.phone;
    var email = form.elements.email;
    // var button = form.elements.btnSubmit;

    function iSnameValid(str) {
      var reg = /[a-zа-яё\D]{3,}\s*?/i;
      return reg.test(str);
    }

    function iSphoneValid(str) {
      var reg = /[+7]\(\d{3}\)\d{3}-\d{4}/;
      return reg.test(str);
    }

    function iSemailValid(str) {
      var reg = /\w+\.?-?\w+@mail\.ru/;
      return reg.test(str);
    }
    // Name validation begin
    inputName.addEventListener("change", validateName);
    inputName.addEventListener("focus", resetName);

    /**
     * validateName - function for validation name's input
     */
    function validateName() {
      if (!iSnameValid(inputName.value)) {
        inputName.classList.add("error");
        var errorEl = document.getElementById("nameError");
        errorEl.classList.add("error");
        errorEl.textContent = "Name is not valid. Please correct it.";

        $("#nameError").css("color", "red").effect("shake", 500);
      }
    }

    /**
     * resetName - function for reset input field with name
     *
     */
    function resetName() {
      if (inputName.classList.contains("error")) {
        // сбросить состояние "ошибка", если оно есть
        inputName.classList.remove("error");
        document.getElementById("nameError").textContent = "";
      }
    }
    // Name validation end

    // Phone number validation begin
    phone.addEventListener("change", validatePhone);
    phone.addEventListener("focus", resetPhone);

    /**
     * validatePhone - function for validation phone number
     *
     */
    function validatePhone() {
      if (!iSphoneValid(phone.value)) {
        phone.classList.add("error");
        var errorEl = document.getElementById("phoneError");
        errorEl.classList.add("error");
        errorEl.textContent = "Phone number is not valid. Please correct it.";
        $("#phoneError").css("color", "red").effect("shake", 500);
      }
    }

    /**
     * resetPhone - function for reset input field with phone
     *
     */
    function resetPhone() {
      if (phone.classList.contains("error")) {
        // сбросить состояние "ошибка", если оно есть
        phone.classList.remove("error");
        document.getElementById("phoneError").textContent = "";
      }
    }
    // Phone number validation end

    // Email input validation begin
    email.addEventListener("change", validateEmail);
    email.addEventListener("focus", resetEmail);

    /**
     * validateEmail - function for validation email input
     *
     */
    function validateEmail() {
      if (!iSemailValid(email.value)) {
        email.classList.add("error");
        var errorEl = document.getElementById("emailError");
        errorEl.classList.add("error");
        errorEl.textContent = "Email input is not valid. Please correct it.";

        $("#emailError").css("color", "red").effect("shake", 500);
      }
    }

    /**
     * resetEmail - function
     * for reset input field with email
     *
     */
    function resetEmail() {
      if (email.classList.contains("error")) {
        // сбросить состояние "ошибка", если оно есть
        email.classList.remove("error");
        document.getElementById("emailError").textContent = "";
      }
    }
    // Email input validation end

    if ($("#nameError").hasClass("error")) {
      $("#nameError").effect("shake", {}, 500, function () {
        setTimeout(function () {
          $("#nameError").removeAttr("style").hide().fadeIn();
        }, 1000);
      });
    }
    //
  });
})(jQuery);

"use strict";

(function ($) {
  $(document).ready(function () {
    var TOWNS_URL = "json/towns.json";
    // var ACTIVE = "active";

    var townsArray;

    $.getJSON(TOWNS_URL, function (data) {
      $.each(data, function (i, town) {
        $("#towns-list").append(town + "<br>");
      });
    }).fail(function () {
      console.log("Fail to load JSON`s Towns List");
    });

    $("#date-pickerID").datepicker({
      monthNames: ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь"],
      dayNamesMin: ["Вс", "Пн", "Вт", "Ср", "Чт", "Пт", "Сб"],
      firstDay: 1,
      dateFormat: "dd.mm.yy"
    });

    //
  });
})(jQuery);

(function () {
  'use strict';

  var sliders = document.querySelectorAll('.slider');
  if (!sliders.length) {
    return;
  }

  Array.prototype.forEach.call(sliders, initSlider);

  function initSlider(slider) {
    var slides = slider.querySelectorAll('.slider__slide');
    if (slides.length < 2) {
      slider.classList.add('slider_inactive');
      return;
    }

    var transitionDuration = app.lib.getTransitionDuration(slides[0]);
    var activeInd = 0;
    var inProgress = false;

    slider.querySelector('.slider__prev').addEventListener('click', function (e) {
      e.preventDefault();
      switchSlide('prev');
    });
    slider.querySelector('.slider__next').addEventListener('click', function (e) {
      e.preventDefault();
      switchSlide('next');
    });

    function switchSlide(dir) {
      if (inProgress) {
        return;
      }
      inProgress = true;
      slides[0].parentNode.style.height = slides[activeInd].offsetHeight + 'px';

      var newInd = dir === 'prev' ? activeInd - 1 : activeInd + 1;
      if (newInd < 0) {
        newInd = slides.length - 1;
      } else if (newInd > slides.length - 1) {
        newInd = 0;
      }

      if (dir === 'prev') {
        slides[activeInd].classList.add('slider__slide_fadingout_prev');
        slides[newInd].classList.add('slider__slide_fadingin_prev');
        slides[0].parentNode.style.height = slides[newInd].offsetHeight + 'px';
        slides[newInd].classList.add('slider__slide_active');
        slides[newInd].classList.remove('slider__slide_fadingin_prev');
      } else {
        slides[activeInd].classList.add('slider__slide_fadingout_next');
        slides[newInd].classList.add('slider__slide_fadingin_next');
        slides[0].parentNode.style.height = slides[newInd].offsetHeight + 'px';
        slides[newInd].classList.add('slider__slide_active');
        slides[newInd].classList.remove('slider__slide_fadingin_next');
      }

      setTimeout(function () {
        slides[0].parentNode.style.height = '';
        slides[activeInd].classList.remove('slider__slide_fadingout_prev');
        slides[activeInd].classList.remove('slider__slide_fadingout_next');
        slides[activeInd].classList.remove('slider__slide_active');
        activeInd = newInd;
        inProgress = false;
      }, transitionDuration);
    }
  }
})();

'use strict';
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdDAxX2Zvcm1fY2hlY2suanMiLCJzY3JpcHQwMS5qcyIsInNsaWRlci5qcyIsImluZGV4LmpzIl0sIm5hbWVzIjpbIiQiLCJkb2N1bWVudCIsInJlYWR5IiwiZm9ybSIsImZvcm1zIiwiZm9ybTAxIiwiaW5wdXROYW1lIiwiZWxlbWVudHMiLCJwaG9uZSIsImVtYWlsIiwiaVNuYW1lVmFsaWQiLCJzdHIiLCJyZWciLCJ0ZXN0IiwiaVNwaG9uZVZhbGlkIiwiaVNlbWFpbFZhbGlkIiwiYWRkRXZlbnRMaXN0ZW5lciIsInZhbGlkYXRlTmFtZSIsInJlc2V0TmFtZSIsInZhbHVlIiwiY2xhc3NMaXN0IiwiYWRkIiwiZXJyb3JFbCIsImdldEVsZW1lbnRCeUlkIiwidGV4dENvbnRlbnQiLCJjc3MiLCJlZmZlY3QiLCJjb250YWlucyIsInJlbW92ZSIsInZhbGlkYXRlUGhvbmUiLCJyZXNldFBob25lIiwidmFsaWRhdGVFbWFpbCIsInJlc2V0RW1haWwiLCJoYXNDbGFzcyIsInNldFRpbWVvdXQiLCJyZW1vdmVBdHRyIiwiaGlkZSIsImZhZGVJbiIsImpRdWVyeSIsIlRPV05TX1VSTCIsInRvd25zQXJyYXkiLCJnZXRKU09OIiwiZGF0YSIsImVhY2giLCJpIiwidG93biIsImFwcGVuZCIsImZhaWwiLCJjb25zb2xlIiwibG9nIiwiZGF0ZXBpY2tlciIsIm1vbnRoTmFtZXMiLCJkYXlOYW1lc01pbiIsImZpcnN0RGF5IiwiZGF0ZUZvcm1hdCIsInNsaWRlcnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGVuZ3RoIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJmb3JFYWNoIiwiY2FsbCIsImluaXRTbGlkZXIiLCJzbGlkZXIiLCJzbGlkZXMiLCJ0cmFuc2l0aW9uRHVyYXRpb24iLCJhcHAiLCJsaWIiLCJnZXRUcmFuc2l0aW9uRHVyYXRpb24iLCJhY3RpdmVJbmQiLCJpblByb2dyZXNzIiwicXVlcnlTZWxlY3RvciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInN3aXRjaFNsaWRlIiwiZGlyIiwicGFyZW50Tm9kZSIsInN0eWxlIiwiaGVpZ2h0Iiwib2Zmc2V0SGVpZ2h0IiwibmV3SW5kIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxDQUFBLFVBQUFBLENBQUEsRUFBQTtBQUNBQSxJQUFBQyxRQUFBLEVBQUFDLEtBQUEsQ0FBQSxZQUFBO0FBQ0EsUUFBQUMsT0FBQUYsU0FBQUcsS0FBQSxDQUFBQyxNQUFBO0FBQ0EsUUFBQUMsWUFBQUgsS0FBQUksUUFBQSxDQUFBRCxTQUFBO0FBQ0EsUUFBQUUsUUFBQUwsS0FBQUksUUFBQSxDQUFBQyxLQUFBO0FBQ0EsUUFBQUMsUUFBQU4sS0FBQUksUUFBQSxDQUFBRSxLQUFBO0FBQ0E7O0FBRUEsYUFBQUMsV0FBQSxDQUFBQyxHQUFBLEVBQUE7QUFDQSxVQUFBQyxNQUFBLHNCQUFBO0FBQ0EsYUFBQUEsSUFBQUMsSUFBQSxDQUFBRixHQUFBLENBQUE7QUFDQTs7QUFFQSxhQUFBRyxZQUFBLENBQUFILEdBQUEsRUFBQTtBQUNBLFVBQUFDLE1BQUEsMEJBQUE7QUFDQSxhQUFBQSxJQUFBQyxJQUFBLENBQUFGLEdBQUEsQ0FBQTtBQUNBOztBQUVBLGFBQUFJLFlBQUEsQ0FBQUosR0FBQSxFQUFBO0FBQ0EsVUFBQUMsTUFBQSxzQkFBQTtBQUNBLGFBQUFBLElBQUFDLElBQUEsQ0FBQUYsR0FBQSxDQUFBO0FBQ0E7QUFDQTtBQUNBTCxjQUFBVSxnQkFBQSxDQUFBLFFBQUEsRUFBQUMsWUFBQTtBQUNBWCxjQUFBVSxnQkFBQSxDQUFBLE9BQUEsRUFBQUUsU0FBQTs7QUFFQTs7O0FBR0EsYUFBQUQsWUFBQSxHQUFBO0FBQ0EsVUFBQSxDQUFBUCxZQUFBSixVQUFBYSxLQUFBLENBQUEsRUFBQTtBQUNBYixrQkFBQWMsU0FBQSxDQUFBQyxHQUFBLENBQUEsT0FBQTtBQUNBLFlBQUFDLFVBQUFyQixTQUFBc0IsY0FBQSxDQUFBLFdBQUEsQ0FBQTtBQUNBRCxnQkFBQUYsU0FBQSxDQUFBQyxHQUFBLENBQUEsT0FBQTtBQUNBQyxnQkFBQUUsV0FB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KSB7XG4gICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXMuZm9ybTAxO1xuICAgIHZhciBpbnB1dE5hbWUgPSBmb3JtLmVsZW1lbnRzLmlucHV0TmFtZTtcbiAgICB2YXIgcGhvbmUgPSBmb3JtLmVsZW1lbnRzLnBob25lO1xuICAgIHZhciBlbWFpbCA9IGZvcm0uZWxlbWVudHMuZW1haWw7XG4gICAgLy8gdmFyIGJ1dHRvbiA9IGZvcm0uZWxlbWVudHMuYnRuU3VibWl0O1xuXG4gICAgZnVuY3Rpb24gaVNuYW1lVmFsaWQoc3RyKSB7XG4gICAgICB2YXIgcmVnID0gL1thLXrQsC3Rj9GRXFxEXXszLH1cXHMqPy9pO1xuICAgICAgcmV0dXJuIHJlZy50ZXN0KHN0cik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaVNwaG9uZVZhbGlkKHN0cikge1xuICAgICAgdmFyIHJlZyA9IC9bKzddXFwoXFxkezN9XFwpXFxkezN9LVxcZHs0fS87XG4gICAgICByZXR1cm4gcmVnLnRlc3Qoc3RyKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpU2VtYWlsVmFsaWQoc3RyKSB7XG4gICAgICB2YXIgcmVnID0gL1xcdytcXC4/LT9cXHcrQG1haWxcXC5ydS87XG4gICAgICByZXR1cm4gcmVnLnRlc3Qoc3RyKTtcbiAgICB9XG4gICAgLy8gTmFtZSB2YWxpZGF0aW9uIGJlZ2luXG4gICAgaW5wdXROYW1lLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgdmFsaWRhdGVOYW1lKTtcbiAgICBpbnB1dE5hbWUuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIHJlc2V0TmFtZSk7XG5cbiAgICAvKipcbiAgICAgKiB2YWxpZGF0ZU5hbWUgLSBmdW5jdGlvbiBmb3IgdmFsaWRhdGlvbiBuYW1lJ3MgaW5wdXRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB2YWxpZGF0ZU5hbWUoKSB7XG4gICAgICBpZiAoIWlTbmFtZVZhbGlkKGlucHV0TmFtZS52YWx1ZSkpIHtcbiAgICAgICAgaW5wdXROYW1lLmNsYXNzTGlzdC5hZGQoXCJlcnJvclwiKTtcbiAgICAgICAgdmFyIGVycm9yRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hbWVFcnJvclwiKTtcbiAgICAgICAgZXJyb3JFbC5jbGFzc0xpc3QuYWRkKFwiZXJyb3JcIik7XG4gICAgICAgIGVycm9yRWwudGV4dENvbnRlbnQgPSBcIk5hbWUgaXMgbm90IHZhbGlkLiBQbGVhc2UgY29ycmVjdCBpdC5cIjtcblxuICAgICAgICAkKFwiI25hbWVFcnJvclwiKVxuICAgICAgICAgIC5jc3MoXCJjb2xvclwiLCBcInJlZFwiKVxuICAgICAgICAgIC5lZmZlY3QoXCJzaGFrZVwiLCA1MDApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHJlc2V0TmFtZSAtIGZ1bmN0aW9uIGZvciByZXNldCBpbnB1dCBmaWVsZCB3aXRoIG5hbWVcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlc2V0TmFtZSgpIHtcbiAgICAgIGlmIChpbnB1dE5hbWUuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZXJyb3JcIikpIHtcbiAgICAgICAgLy8g0YHQsdGA0L7RgdC40YLRjCDRgdC+0YHRgtC+0Y/QvdC40LUgXCLQvtGI0LjQsdC60LBcIiwg0LXRgdC70Lgg0L7QvdC+INC10YHRgtGMXG4gICAgICAgIGlucHV0TmFtZS5jbGFzc0xpc3QucmVtb3ZlKFwiZXJyb3JcIik7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmFtZUVycm9yXCIpLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gTmFtZSB2YWxpZGF0aW9uIGVuZFxuXG4gICAgLy8gUGhvbmUgbnVtYmVyIHZhbGlkYXRpb24gYmVnaW5cbiAgICBwaG9uZS5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIHZhbGlkYXRlUGhvbmUpO1xuICAgIHBob25lLmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCByZXNldFBob25lKTtcblxuICAgIC8qKlxuICAgICAqIHZhbGlkYXRlUGhvbmUgLSBmdW5jdGlvbiBmb3IgdmFsaWRhdGlvbiBwaG9uZSBudW1iZXJcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHZhbGlkYXRlUGhvbmUoKSB7XG4gICAgICBpZiAoIWlTcGhvbmVWYWxpZChwaG9uZS52YWx1ZSkpIHtcbiAgICAgICAgcGhvbmUuY2xhc3NMaXN0LmFkZChcImVycm9yXCIpO1xuICAgICAgICB2YXIgZXJyb3JFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGhvbmVFcnJvclwiKTtcbiAgICAgICAgZXJyb3JFbC5jbGFzc0xpc3QuYWRkKFwiZXJyb3JcIik7XG4gICAgICAgIGVycm9yRWwudGV4dENvbnRlbnQgPSBcIlBob25lIG51bWJlciBpcyBub3QgdmFsaWQuIFBsZWFzZSBjb3JyZWN0IGl0LlwiO1xuICAgICAgICAkKFwiI3Bob25lRXJyb3JcIilcbiAgICAgICAgICAuY3NzKFwiY29sb3JcIiwgXCJyZWRcIilcbiAgICAgICAgICAuZWZmZWN0KFwic2hha2VcIiwgNTAwKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXNldFBob25lIC0gZnVuY3Rpb24gZm9yIHJlc2V0IGlucHV0IGZpZWxkIHdpdGggcGhvbmVcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlc2V0UGhvbmUoKSB7XG4gICAgICBpZiAocGhvbmUuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZXJyb3JcIikpIHtcbiAgICAgICAgLy8g0YHQsdGA0L7RgdC40YLRjCDRgdC+0YHRgtC+0Y/QvdC40LUgXCLQvtGI0LjQsdC60LBcIiwg0LXRgdC70Lgg0L7QvdC+INC10YHRgtGMXG4gICAgICAgIHBob25lLmNsYXNzTGlzdC5yZW1vdmUoXCJlcnJvclwiKTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaG9uZUVycm9yXCIpLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gUGhvbmUgbnVtYmVyIHZhbGlkYXRpb24gZW5kXG5cbiAgICAvLyBFbWFpbCBpbnB1dCB2YWxpZGF0aW9uIGJlZ2luXG4gICAgZW1haWwuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCB2YWxpZGF0ZUVtYWlsKTtcbiAgICBlbWFpbC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgcmVzZXRFbWFpbCk7XG5cbiAgICAvKipcbiAgICAgKiB2YWxpZGF0ZUVtYWlsIC0gZnVuY3Rpb24gZm9yIHZhbGlkYXRpb24gZW1haWwgaW5wdXRcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHZhbGlkYXRlRW1haWwoKSB7XG4gICAgICBpZiAoIWlTZW1haWxWYWxpZChlbWFpbC52YWx1ZSkpIHtcbiAgICAgICAgZW1haWwuY2xhc3NMaXN0LmFkZChcImVycm9yXCIpO1xuICAgICAgICB2YXIgZXJyb3JFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZW1haWxFcnJvclwiKTtcbiAgICAgICAgZXJyb3JFbC5jbGFzc0xpc3QuYWRkKFwiZXJyb3JcIik7XG4gICAgICAgIGVycm9yRWwudGV4dENvbnRlbnQgPSBcIkVtYWlsIGlucHV0IGlzIG5vdCB2YWxpZC4gUGxlYXNlIGNvcnJlY3QgaXQuXCI7XG5cbiAgICAgICAgJChcIiNlbWFpbEVycm9yXCIpXG4gICAgICAgICAgLmNzcyhcImNvbG9yXCIsIFwicmVkXCIpXG4gICAgICAgICAgLmVmZmVjdChcInNoYWtlXCIsIDUwMCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmVzZXRFbWFpbCAtIGZ1bmN0aW9uXG4gICAgICogZm9yIHJlc2V0IGlucHV0IGZpZWxkIHdpdGggZW1haWxcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlc2V0RW1haWwoKSB7XG4gICAgICBpZiAoZW1haWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZXJyb3JcIikpIHtcbiAgICAgICAgLy8g0YHQsdGA0L7RgdC40YLRjCDRgdC+0YHRgtC+0Y/QvdC40LUgXCLQvtGI0LjQsdC60LBcIiwg0LXRgdC70Lgg0L7QvdC+INC10YHRgtGMXG4gICAgICAgIGVtYWlsLmNsYXNzTGlzdC5yZW1vdmUoXCJlcnJvclwiKTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlbWFpbEVycm9yXCIpLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gRW1haWwgaW5wdXQgdmFsaWRhdGlvbiBlbmRcblxuICAgIGlmICgkKFwiI25hbWVFcnJvclwiKS5oYXNDbGFzcyhcImVycm9yXCIpKSB7XG4gICAgICAkKFwiI25hbWVFcnJvclwiKS5lZmZlY3QoXCJzaGFrZVwiLCB7fSwgNTAwLCBmdW5jdGlvbigpIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAkKFwiI25hbWVFcnJvclwiKVxuICAgICAgICAgICAgLnJlbW92ZUF0dHIoXCJzdHlsZVwiKVxuICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgLmZhZGVJbigpO1xuICAgICAgICB9LCAxMDAwKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICAvL1xuICB9KTtcbn0pKGpRdWVyeSk7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uKCQpIHtcbiAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgdmFyIFRPV05TX1VSTCA9IFwianNvbi90b3ducy5qc29uXCI7XG4gICAgLy8gdmFyIEFDVElWRSA9IFwiYWN0aXZlXCI7XG5cbiAgICB2YXIgdG93bnNBcnJheTtcblxuICAgICQuZ2V0SlNPTihUT1dOU19VUkwsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICQuZWFjaChkYXRhLCBmdW5jdGlvbihpLCB0b3duKSB7XG4gICAgICAgICQoXCIjdG93bnMtbGlzdFwiKS5hcHBlbmQodG93biArIFwiPGJyPlwiKTtcbiAgICAgIH0pO1xuICAgIH0pLmZhaWwoZnVuY3Rpb24oKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkZhaWwgdG8gbG9hZCBKU09OYHMgVG93bnMgTGlzdFwiKTtcbiAgICB9KTtcblxuICAgICQoXCIjZGF0ZS1waWNrZXJJRFwiKS5kYXRlcGlja2VyKHtcbiAgICAgIG1vbnRoTmFtZXM6IFtcbiAgICAgICAgXCLQr9C90LLQsNGA0YxcIixcbiAgICAgICAgXCLQpNC10LLRgNCw0LvRjFwiLFxuICAgICAgICBcItCc0LDRgNGCXCIsXG4gICAgICAgIFwi0JDQv9GA0LXQu9GMXCIsXG4gICAgICAgIFwi0JzQsNC5XCIsXG4gICAgICAgIFwi0JjRjtC90YxcIixcbiAgICAgICAgXCLQmNGO0LvRjFwiLFxuICAgICAgICBcItCQ0LLQs9GD0YHRglwiLFxuICAgICAgICBcItCh0LXQvdGC0Y/QsdGA0YxcIixcbiAgICAgICAgXCLQntC60YLRj9Cx0YDRjFwiXG4gICAgICBdLFxuICAgICAgZGF5TmFtZXNNaW46IFtcItCS0YFcIiwgXCLQn9C9XCIsIFwi0JLRglwiLCBcItCh0YBcIiwgXCLQp9GCXCIsIFwi0J/RglwiLCBcItCh0LFcIl0sXG4gICAgICBmaXJzdERheTogMSxcbiAgICAgIGRhdGVGb3JtYXQ6IFwiZGQubW0ueXlcIlxuICAgIH0pO1xuXG4gICAgLy9cbiAgfSk7XG59KShqUXVlcnkpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBjb25zdCBzbGlkZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNsaWRlcicpO1xuICBpZiAoIXNsaWRlcnMubGVuZ3RoKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChzbGlkZXJzLCBpbml0U2xpZGVyKTtcblxuICBmdW5jdGlvbiBpbml0U2xpZGVyKHNsaWRlcikge1xuICAgIGNvbnN0IHNsaWRlcyA9IHNsaWRlci5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGVyX19zbGlkZScpO1xuICAgIGlmIChzbGlkZXMubGVuZ3RoIDwgMikge1xuICAgICAgc2xpZGVyLmNsYXNzTGlzdC5hZGQoJ3NsaWRlcl9pbmFjdGl2ZScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHRyYW5zaXRpb25EdXJhdGlvbiA9IGFwcC5saWIuZ2V0VHJhbnNpdGlvbkR1cmF0aW9uKHNsaWRlc1swXSk7XG4gICAgbGV0IGFjdGl2ZUluZCA9IDA7XG4gICAgbGV0IGluUHJvZ3Jlc3MgPSBmYWxzZTtcblxuICAgIHNsaWRlci5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyX19wcmV2JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHN3aXRjaFNsaWRlKCdwcmV2Jyk7XG4gICAgfSk7XG4gICAgc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXJfX25leHQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgc3dpdGNoU2xpZGUoJ25leHQnKTtcbiAgICB9KTtcblxuXG4gICAgZnVuY3Rpb24gc3dpdGNoU2xpZGUoZGlyKSB7XG4gICAgICBpZiAoaW5Qcm9ncmVzcykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpblByb2dyZXNzID0gdHJ1ZTtcbiAgICAgIHNsaWRlc1swXS5wYXJlbnROb2RlLnN0eWxlLmhlaWdodCA9IHNsaWRlc1thY3RpdmVJbmRdLm9mZnNldEhlaWdodCArICdweCc7XG5cblxuICAgICAgbGV0IG5ld0luZCA9IGRpciA9PT0gJ3ByZXYnID8gYWN0aXZlSW5kIC0gMSA6IGFjdGl2ZUluZCArIDE7XG4gICAgICBpZiAobmV3SW5kIDwgMCkge1xuICAgICAgICBuZXdJbmQgPSBzbGlkZXMubGVuZ3RoIC0gMTtcbiAgICAgIH0gZWxzZSBpZiAobmV3SW5kID4gc2xpZGVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgbmV3SW5kID0gMDtcbiAgICAgIH1cblxuICAgICAgaWYgKGRpciA9PT0gJ3ByZXYnKSB7XG4gICAgICAgIHNsaWRlc1thY3RpdmVJbmRdLmNsYXNzTGlzdC5hZGQoJ3NsaWRlcl9fc2xpZGVfZmFkaW5nb3V0X3ByZXYnKTtcbiAgICAgICAgc2xpZGVzW25ld0luZF0uY2xhc3NMaXN0LmFkZCgnc2xpZGVyX19zbGlkZV9mYWRpbmdpbl9wcmV2Jyk7XG4gICAgICAgIHNsaWRlc1swXS5wYXJlbnROb2RlLnN0eWxlLmhlaWdodCA9IHNsaWRlc1tuZXdJbmRdLm9mZnNldEhlaWdodCArICdweCc7XG4gICAgICAgIHNsaWRlc1tuZXdJbmRdLmNsYXNzTGlzdC5hZGQoJ3NsaWRlcl9fc2xpZGVfYWN0aXZlJyk7XG4gICAgICAgIHNsaWRlc1tuZXdJbmRdLmNsYXNzTGlzdC5yZW1vdmUoJ3NsaWRlcl9fc2xpZGVfZmFkaW5naW5fcHJldicpO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzbGlkZXNbYWN0aXZlSW5kXS5jbGFzc0xpc3QuYWRkKCdzbGlkZXJfX3NsaWRlX2ZhZGluZ291dF9uZXh0Jyk7XG4gICAgICAgIHNsaWRlc1tuZXdJbmRdLmNsYXNzTGlzdC5hZGQoJ3NsaWRlcl9fc2xpZGVfZmFkaW5naW5fbmV4dCcpO1xuICAgICAgICBzbGlkZXNbMF0ucGFyZW50Tm9kZS5zdHlsZS5oZWlnaHQgPSBzbGlkZXNbbmV3SW5kXS5vZmZzZXRIZWlnaHQgKyAncHgnO1xuICAgICAgICBzbGlkZXNbbmV3SW5kXS5jbGFzc0xpc3QuYWRkKCdzbGlkZXJfX3NsaWRlX2FjdGl2ZScpO1xuICAgICAgICBzbGlkZXNbbmV3SW5kXS5jbGFzc0xpc3QucmVtb3ZlKCdzbGlkZXJfX3NsaWRlX2ZhZGluZ2luX25leHQnKTtcbiAgICAgIH1cblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHNsaWRlc1swXS5wYXJlbnROb2RlLnN0eWxlLmhlaWdodCA9ICcnO1xuICAgICAgICBzbGlkZXNbYWN0aXZlSW5kXS5jbGFzc0xpc3QucmVtb3ZlKCdzbGlkZXJfX3NsaWRlX2ZhZGluZ291dF9wcmV2Jyk7XG4gICAgICAgIHNsaWRlc1thY3RpdmVJbmRdLmNsYXNzTGlzdC5yZW1vdmUoJ3NsaWRlcl9fc2xpZGVfZmFkaW5nb3V0X25leHQnKTtcbiAgICAgICAgc2xpZGVzW2FjdGl2ZUluZF0uY2xhc3NMaXN0LnJlbW92ZSgnc2xpZGVyX19zbGlkZV9hY3RpdmUnKTtcbiAgICAgICAgYWN0aXZlSW5kID0gbmV3SW5kO1xuICAgICAgICBpblByb2dyZXNzID0gZmFsc2U7XG4gICAgICB9LCB0cmFuc2l0aW9uRHVyYXRpb24pO1xuICAgIH1cbiAgfVxufSkoKTtcbiIsIid1c2Ugc3RyaWN0JzsiXX0=
